<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cross Experience - Avalia√ß√£o de Desempenho</title>
    
    <!-- Bibliotecas CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 20px;
        }

        .header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .hashtag {
            color: #764ba2;
            font-weight: bold;
            margin-top: 10px;
            font-size: 1.2em;
        }

        .admin-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .user-badge {
            background: #e5e7eb;
            color: #666;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
        }

        .export-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .btn-pdf {
            background: #dc2626;
            color: white;
        }

        .btn-excel {
            background: #16a34a;
            color: white;
        }

        .btn-ppt {
            background: #ea580c;
            color: white;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-secondary {
            background: #764ba2;
            color: white;
        }

        .btn-warning {
            background: #f59e0b;
            color: white;
        }

        .btn-danger {
            background: #dc2626;
            color: white;
        }

        .btn-success {
            background: #16a34a;
            color: white;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 0.85em;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 15px 30px;
            background: rgba(255,255,255,0.9);
            border: none;
            border-radius: 10px 10px 0 0;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s;
            color: #667eea;
        }

        .tab.active {
            background: white;
            color: #764ba2;
            transform: translateY(-5px);
        }

        .tab.hidden {
            display: none;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }

        input[type="text"],
        input[type="password"],
        input[type="date"],
        textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
            font-family: inherit;
        }

        input:focus,
        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .classification-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 15px;
        }

        .classification-option {
            padding: 20px;
            border: 3px solid #e5e7eb;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
        }

        .classification-option:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .classification-option.selected {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .classification-option.yellow {
            background: #fef3c7;
        }

        .classification-option.yellow.selected {
            background: #fde68a;
            border-color: #f59e0b;
        }

        .classification-option.blue {
            background: #dbeafe;
        }

        .classification-option.blue.selected {
            background: #bfdbfe;
            border-color: #3b82f6;
        }

        .classification-option strong {
            display: block;
            font-size: 1.2em;
            margin-bottom: 8px;
        }

        .classification-option p {
            font-size: 0.9em;
            color: #666;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-number {
            font-size: 3em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 1em;
            opacity: 0.9;
        }

        .evaluation-list {
            margin-top: 20px;
        }

        .evaluation-item {
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s;
            position: relative;
        }

        .evaluation-item:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .evaluation-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 10px;
        }

        .evaluation-name {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
        }

        .evaluation-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
        }

        .badge-yellow {
            background: #fef3c7;
            color: #92400e;
        }

        .badge-blue {
            background: #dbeafe;
            color: #1e40af;
        }

        .evaluation-details {
            color: #666;
            line-height: 1.6;
        }

        .home-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .feature-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.3s;
            border: 3px solid transparent;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border-color: #667eea;
        }

        .feature-card h3 {
            color: #667eea;
            font-size: 1.5em;
            margin-bottom: 15px;
        }

        .feature-card p {
            color: #666;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .mini-matrix {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin: 15px 0;
        }

        .mini-cell {
            padding: 12px;
            border-radius: 6px;
            font-size: 0.85em;
            text-align: center;
        }

        .mini-cell strong {
            display: block;
            margin-bottom: 4px;
        }

        .distribution-bar {
            margin: 15px 0;
        }

        .distribution-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 0.95em;
        }

        .progress-bar {
            height: 25px;
            background: #e5e7eb;
            border-radius: 12px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.85em;
        }

        .question-list {
            list-style: none;
            margin: 15px 0;
        }

        .question-list li {
            padding: 8px 0;
            border-bottom: 1px solid #e5e7eb;
            color: #666;
        }

        .question-list li:before {
            content: "‚úì ";
            color: #764ba2;
            font-weight: bold;
            margin-right: 8px;
        }

        .alert {
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .alert-info {
            background: #e0f2fe;
            color: #0c4a6e;
            border-left: 4px solid #0284c7;
        }

        .alert-success {
            background: #d1fae5;
            color: #065f46;
            border-left: 4px solid #059669;
        }

        .alert-warning {
            background: #fef3c7;
            color: #92400e;
            border-left: 4px solid #f59e0b;
        }

        .question-editor {
            background: #f9fafb;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border: 2px solid #e5e7eb;
        }

        .question-number {
            display: inline-block;
            background: #667eea;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            margin-right: 10px;
        }

        .title-editor {
            background: #f0f4ff;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            border: 3px solid #667eea;
        }

        .title-editor input {
            font-size: 1.2em;
            font-weight: bold;
            color: #667eea;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            animation: fadeIn 0.3s;
        }

        .modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideDown 0.3s;
        }

        .modal-content h2 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .modal-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideDown {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .header-top {
                flex-direction: column;
                gap: 15px;
            }

            .classification-grid {
                grid-template-columns: 1fr;
            }

            .export-buttons {
                flex-direction: column;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }

            .tabs {
                flex-direction: column;
            }

            .tab {
                text-align: center;
            }

            .evaluation-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-top">
                <div>
                    <h1>Cross Experience</h1>
                    <p>Sistema de Avalia√ß√£o de Desempenho</p>
                    <p class="hashtag">#MELHORIACONTINUA</p>
                </div>
                <div>
                    <div id="user-status">
                        <span class="user-badge">üë§ Modo Usu√°rio</span>
                    </div>
                    <button class="btn btn-primary btn-small" onclick="toggleAdminMode()" style="margin-top: 10px;">
                        üîê Admin
                    </button>
                </div>
            </div>
            
            <div class="export-buttons" id="admin-buttons" style="display: none;">
                <button class="btn btn-pdf" onclick="exportarPDF()">
                    üìÑ Exportar PDF
                </button>
                <button class="btn btn-excel" onclick="exportarExcel()">
                    üìä Exportar Excel
                </button>
                <button class="btn btn-ppt" onclick="exportarApresentacao()">
                    üìΩÔ∏è Gerar Apresenta√ß√£o
                </button>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab active" onclick="showTab('home')">In√≠cio</button>
            <button class="tab" onclick="showTab('avaliacao')">Avalia√ß√£o de Desempenho</button>
            <button class="tab" onclick="showTab('oneonone')"><span id="tab-titulo">One-on-One 7.5</span></button>
            <button class="tab hidden" id="tab-dashboard" onclick="showTab('dashboard')">Dashboard</button>
            <button class="tab hidden" id="tab-config" onclick="showTab('config')">‚öôÔ∏è Configura√ß√µes</button>
        </div>

        <!-- Tab: In√≠cio -->
        <div id="home" class="tab-content active">
            <div class="home-grid">
                <div class="feature-card" onclick="showTab('avaliacao')">
                    <h3>üë• Avalia√ß√£o de Desempenho</h3>
                    <p>Matriz 2x2 para classificar colaboradores com base em desempenho e valores organizacionais.</p>
                    
                    <div class="mini-matrix">
                        <div class="mini-cell" style="background: #fef3c7;">
                            <strong>Avaliar Caso</strong>
                            <small>Alto/Baixo</small>
                        </div>
                        <div class="mini-cell" style="background: #fde68a;">
                            <strong>Delegar</strong>
                            <small>Alto/Alto</small>
                        </div>
                        <div class="mini-cell" style="background: #dbeafe;">
                            <strong>Desligar</strong>
                            <small>Baixo/Baixo</small>
                        </div>
                        <div class="mini-cell" style="background: #bfdbfe;">
                            <strong>Desenvolver</strong>
                            <small>Baixo/Alto</small>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary" style="width: 100%;">Iniciar Avalia√ß√£o</button>
                </div>

                <div class="feature-card" onclick="showTab('oneonone')">
                    <h3 id="home-card-titulo">üìã One-on-One 7.5</h3>
                    <p>Question√°rio estruturado com 5 perguntas estrat√©gicas para feedback e desenvolvimento.</p>
                    
                    <ul class="question-list" id="home-questions-preview">
                        <!-- Ser√° preenchido dinamicamente -->
                    </ul>
                    
                    <button class="btn btn-secondary" style="width: 100%;">Iniciar Formul√°rio</button>
                </div>
            </div>

            <div class="card" style="margin-top: 20px;" id="home-stats">
                <h2>üìä Estat√≠sticas R√°pidas</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="stat-avaliacoes">0</div>
                        <div class="stat-label">Avalia√ß√µes de Desempenho</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="stat-oneonones">0</div>
                        <div class="stat-label" id="stat-oneonones-label">One-on-Ones</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="stat-total">0</div>
                        <div class="stat-label">Total de Avalia√ß√µes</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab: Avalia√ß√£o de Desempenho -->
        <div id="avaliacao" class="tab-content">
            <div class="card">
                <h2>Nova Avalia√ß√£o de Desempenho</h2>
                
                <div id="edit-alert" class="alert alert-warning" style="display: none;">
                    <span style="font-size: 1.5em;">‚úèÔ∏è</span>
                    <div>
                        <strong>Modo Edi√ß√£o!</strong><br>
                        Voc√™ est√° editando uma avalia√ß√£o existente. As altera√ß√µes substituir√£o os dados anteriores.
                    </div>
                </div>
                
                <form id="form-avaliacao">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <div class="form-group">
                            <label>Nome do Avaliado *</label>
                            <input type="text" id="avaliado" required placeholder="Digite o nome do colaborador">
                        </div>
                        
                        <div class="form-group">
                            <label>Nome do Avaliador *</label>
                            <input type="text" id="avaliador" required placeholder="Digite o nome do avaliador">
                        </div>
                        
                        <div class="form-group">
                            <label>Data da Avalia√ß√£o</label>
                            <input type="date" id="data-avaliacao">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Classifica√ß√£o *</label>
                        <div class="classification-grid">
                            <div class="classification-option yellow" onclick="selectClassification('Delegar desafios')">
                                <strong>Delegar Desafios</strong>
                                <p>Alto Desempenho + Altos Valores</p>
                            </div>
                            <div class="classification-option yellow" onclick="selectClassification('Avaliar cada caso (est√¥mago)')">
                                <strong>Avaliar Cada Caso</strong>
                                <p>Alto Desempenho + Baixos Valores</p>
                            </div>
                            <div class="classification-option blue" onclick="selectClassification('Desenvolver')">
                                <strong>Desenvolver</strong>
                                <p>Baixo Desempenho + Altos Valores</p>
                            </div>
                            <div class="classification-option blue" onclick="selectClassification('Desligar')">
                                <strong>Desligar</strong>
                                <p>Baixo Desempenho + Baixos Valores</p>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Observa√ß√µes e Notas</label>
                        <textarea id="observacoes" placeholder="Adicione observa√ß√µes, feedbacks ou notas importantes sobre esta avalia√ß√£o..."></textarea>
                    </div>

                    <div style="display: flex; gap: 15px;">
                        <button type="submit" class="btn btn-primary" style="flex: 1;">
                            üíæ Salvar Avalia√ß√£o
                        </button>
                        <button type="button" id="cancel-edit-av" class="btn btn-secondary" onclick="cancelarEdicaoAvaliacao()" style="display: none;">
                            ‚ùå Cancelar Edi√ß√£o
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Tab: One-on-One -->
        <div id="oneonone" class="tab-content">
            <div class="card">
                <h2 id="form-titulo">Novo One-on-One 7.5</h2>
                
                <div id="edit-alert-ooo" class="alert alert-warning" style="display: none;">
                    <span style="font-size: 1.5em;">‚úèÔ∏è</span>
                    <div>
                        <strong>Modo Edi√ß√£o!</strong><br>
                        Voc√™ est√° editando um formul√°rio existente. As altera√ß√µes substituir√£o os dados anteriores.
                    </div>
                </div>
                
                <form id="form-oneonone">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                        <div class="form-group">
                            <label>Nome do Avaliador *</label>
                            <input type="text" id="ooo-avaliador" required placeholder="Seu nome">
                        </div>
                        
                        <div class="form-group">
                            <label>Nome do Avaliado *</label>
                            <input type="text" id="ooo-avaliado" required placeholder="Nome do colaborador">
                        </div>
                        
                        <div class="form-group">
                            <label>Departamento</label>
                            <input type="text" id="departamento" placeholder="Ex: Vendas">
                        </div>
                        
                        <div class="form-group">
                            <label>Data</label>
                            <input type="date" id="data-oneonone">
                        </div>
                    </div>

                    <h3 style="margin: 30px 0 20px; color: #667eea;">Perguntas</h3>

                    <div id="questions-container">
                        <!-- As perguntas ser√£o carregadas dinamicamente aqui -->
                    </div>

                    <div style="display: flex; gap: 15px;">
                        <button type="submit" class="btn btn-secondary" style="flex: 1;">
                            üíæ Salvar Formul√°rio
                        </button>
                        <button type="button" id="cancel-edit-ooo" class="btn btn-secondary" onclick="cancelarEdicaoOneOnOne()" style="display: none;">
                            ‚ùå Cancelar Edi√ß√£o
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Tab: Configura√ß√µes -->
        <div id="config" class="tab-content">
            <div class="card">
                <h2>‚öôÔ∏è Configura√ß√µes do Formul√°rio</h2>
                
                <div class="alert alert-info">
                    <span style="font-size: 1.5em;">üí°</span>
                    <div>
                        <strong>Personalize seu formul√°rio!</strong><br>
                        Edite o t√≠tulo e as 5 perguntas conforme necess√°rio. As mudan√ßas ser√£o aplicadas em todos os novos formul√°rios.
                    </div>
                </div>

                <div class="title-editor">
                    <label style="font-size: 1.3em; color: #667eea;">üìù T√≠tulo do Formul√°rio</label>
                    <input type="text" id="config-titulo" placeholder="Ex: One-on-One 7.5, Conversa Mensal, Feedback 360..." 
                           style="margin-top: 10px;">
                    <p style="margin-top: 10px; color: #666; font-size: 0.9em;">
                        üí° Dica: Mude mensalmente (Ex: "One-on-One Janeiro 2025" ou "Feedback Trimestral Q1")
                    </p>
                </div>

                <h3 style="margin: 30px 0 20px;">üìã Perguntas do Formul√°rio</h3>

                <div class="question-editor">
                    <label><span class="question-number">1</span> Pergunta 1</label>
                    <textarea id="config-q1" rows="2" placeholder="Digite a primeira pergunta..."></textarea>
                </div>

                <div class="question-editor">
                    <label><span class="question-number">2</span> Pergunta 2</label>
                    <textarea id="config-q2" rows="2" placeholder="Digite a segunda pergunta..."></textarea>
                </div>

                <div class="question-editor">
                    <label><span class="question-number">3</span> Pergunta 3</label>
                    <textarea id="config-q3" rows="2" placeholder="Digite a terceira pergunta..."></textarea>
                </div>

                <div class="question-editor">
                    <label><span class="question-number">4</span> Pergunta 4</label>
                    <textarea id="config-q4" rows="2" placeholder="Digite a quarta pergunta..."></textarea>
                </div>

                <div class="question-editor">
                    <label><span class="question-number">5</span> Pergunta 5</label>
                    <textarea id="config-q5" rows="2" placeholder="Digite a quinta pergunta..."></textarea>
                </div>

                <h3 style="margin: 30px 0 20px;">‚òÅÔ∏è Integra√ß√£o com Google Sheets</h3>
                <div class="alert alert-info">
                    <span style="font-size: 1.5em;">‚òÅÔ∏è</span>
                    <div>
                        <strong>Sincronize com a Nuvem!</strong><br>
                        Conecte com Google Sheets para que todos vejam os mesmos dados em tempo real.<br>
                        <small style="color: #1e40af; margin-top: 5px; display: block;">
                            üìö Tutorial completo: <strong>TUTORIAL_INTEGRACAO_GOOGLE_SHEETS.md</strong>
                        </small>
                    </div>
                </div>

                <div class="form-group">
                    <label>URL da API (Google Apps Script)</label>
                    <input type="text" id="config-api-url" placeholder="https://script.google.com/macros/s/..." style="font-size: 0.9em;">
                    <small style="color: #666; display: block; margin-top: 5px;">
                        Cole aqui a URL COMPLETA do Web App ap√≥s publicar o Apps Script
                    </small>
                </div>

                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" id="config-usar-nuvem" style="width: auto; margin: 0;">
                        <span>Ativar sincroniza√ß√£o autom√°tica com nuvem</span>
                    </label>
                    <small style="color: #666; display: block; margin-top: 5px; margin-left: 30px;">
                        Quando ativado, todas as avalia√ß√µes e configura√ß√µes ser√£o salvas no Google Sheets
                    </small>
                </div>

                <div id="status-conexao" style="padding: 15px; border-radius: 8px; margin: 15px 0; display: none;">
                    <!-- Status ser√° mostrado aqui -->
                </div>

                <button class="btn btn-primary" onclick="testarEConfigurarAPI()" style="margin-bottom: 20px; width: 100%;">
                    üîó Testar e Salvar Conex√£o
                </button>

                <h3 style="margin: 30px 0 20px;">üîê Senha de Administrador</h3>
                <div class="alert alert-warning">
                    <span style="font-size: 1.5em;">‚ö†Ô∏è</span>
                    <div>
                        <strong>Aten√ß√£o!</strong><br>
                        Defina uma senha para proteger o acesso administrativo. Guarde-a em local seguro!<br>
                        <small style="color: #92400e; margin-top: 5px; display: block;">üí° Senha atual padr√£o: <strong>admin</strong></small>
                    </div>
                </div>
                <div class="form-group">
                    <label>Senha Admin</label>
                    <input type="password" id="config-senha" placeholder="Digite a nova senha (deixe em branco para manter atual)">
                </div>

                <div style="display: flex; gap: 15px; margin-top: 20px;">
                    <button class="btn btn-primary" onclick="salvarConfiguracoes()" style="flex: 1;">
                        üíæ Salvar Configura√ß√µes
                    </button>
                    <button class="btn btn-warning" onclick="restaurarPadrao()">
                        üîÑ Restaurar Padr√£o
                    </button>
                </div>
            </div>
        </div>

        <!-- Tab: Dashboard -->
        <div id="dashboard" class="tab-content">
            <div class="card">
                <h2>üìä Resumo Geral</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="dash-avaliacoes">0</div>
                        <div class="stat-label">Avalia√ß√µes de Desempenho</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="dash-oneonones">0</div>
                        <div class="stat-label" id="dash-oneonones-label">Formul√°rios</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="dash-total">0</div>
                        <div class="stat-label">Total de Avalia√ß√µes</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="dash-unicos">0</div>
                        <div class="stat-label">Colaboradores √önicos</div>
                    </div>
                </div>
            </div>

            <div id="distribution-section" class="card" style="display: none;">
                <h2>üìà Distribui√ß√£o por Classifica√ß√£o</h2>
                <div id="distribution-content"></div>
            </div>

            <div id="avaliacoes-list" class="card" style="display: none;">
                <h2>üìã √öltimas Avalia√ß√µes de Desempenho</h2>
                <div id="avaliacoes-content" class="evaluation-list"></div>
            </div>

            <div id="oneonones-list" class="card" style="display: none;">
                <h2 id="dash-oneonones-titulo">üí¨ √öltimos Formul√°rios</h2>
                <div id="oneonones-content" class="evaluation-list"></div>
            </div>

            <div id="empty-state" class="card">
                <div style="text-align: center; padding: 40px;">
                    <p style="font-size: 1.3em; color: #999; margin-bottom: 10px;">Nenhuma avalia√ß√£o registrada ainda.</p>
                    <p style="color: #666;">Comece criando uma nova avalia√ß√£o!</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Login Admin -->
    <div id="modal-login" class="modal">
        <div class="modal-content">
            <h2>üîê Acesso Administrativo</h2>
            <p style="color: #666; margin-bottom: 10px;">Digite a senha para acessar o modo administrador</p>
            <p style="color: #667eea; font-size: 0.9em; margin-bottom: 20px;">
                üí° Senha padr√£o: <strong>admin</strong>
            </p>
            <div class="form-group">
                <label>Senha</label>
                <input type="password" id="login-senha" placeholder="Digite: admin">
            </div>
            <div style="text-align: center; margin: 10px 0;">
                <button onclick="resetarSenha()" style="background: none; border: none; color: #667eea; text-decoration: underline; cursor: pointer; font-size: 0.9em;">
                    Esqueci a senha / Resetar para "admin"
                </button>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-primary" onclick="fazerLogin()" style="flex: 1;">
                    ‚úÖ Entrar
                </button>
                <button class="btn btn-secondary" onclick="fecharModal()">
                    ‚ùå Cancelar
                </button>
            </div>
        </div>
    </div>

    <script>
        // Vari√°veis globais
        let avaliacoes = [];
        let oneOnOnes = [];
        let selectedClassification = '';
        let isAdmin = false;
        let adminPassword = 'admin'; // Senha padr√£o
        let editandoAvaliacao = null; // ID da avalia√ß√£o sendo editada
        let editandoOneOnOne = null; // ID do one-on-one sendo editado
        
        // Integra√ß√£o com Google Sheets
        let apiUrl = localStorage.getItem('apiUrl') || '';
        let usarNuvem = localStorage.getItem('usarNuvem') === 'true';
        let carregando = false;
        
        // Configura√ß√µes padr√£o
        const tituloPadrao = "One-on-One 7.5";
        const perguntasPadrao = [
            "O que voc√™ gostaria de receber mais da sua lideran√ßa: direcionamento, autonomia ou reconhecimento?",
            "Como voc√™ avalia o alinhamento entre o que a empresa fala (miss√µes, vis√µes e valores) e o que ela faz no dia a dia?",
            "Voc√™ sente que pode ser aut√™ntico no time ou precisa \"se moldar\" para se encaixar?",
            "Que melhorias voc√™ sugeriria para simplificar a nossa rotina operacional?",
            "Se pudesse dar um conselho direto para a sua lideran√ßa, qual seria?"
        ];
        
        let titulo = tituloPadrao;
        let perguntas = [...perguntasPadrao];

        // Carregar dados ao iniciar
        window.onload = async function() {
            await loadData();
            loadConfiguracoes();
            updateStats();
            updateDashboard();
            renderQuestions();
            updateAllTitles();
            updateHomePreview();
            checkAdminMode();
            
            const hoje = new Date().toISOString().split('T')[0];
            document.getElementById('data-avaliacao').value = hoje;
            document.getElementById('data-oneonone').value = hoje;
            
            // Suporte para tecla Enter no login
            document.getElementById('login-senha').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    fazerLogin();
                }
            });
        };

        // Sistema de Admin
        function checkAdminMode() {
            const savedAdmin = sessionStorage.getItem('isAdmin');
            if (savedAdmin === 'true') {
                isAdmin = true;
                updateUIMode();
            }
        }

        function toggleAdminMode() {
            if (isAdmin) {
                // Fazer logout
                if (confirm('Deseja sair do modo administrador?')) {
                    isAdmin = false;
                    sessionStorage.removeItem('isAdmin');
                    updateUIMode();
                    showTab('home');
                    alert('‚úÖ Logout realizado com sucesso!');
                }
            } else {
                // Fazer login
                document.getElementById('modal-login').classList.add('active');
                document.getElementById('login-senha').value = '';
                document.getElementById('login-senha').focus();
            }
        }

        function fazerLogin() {
            const senha = document.getElementById('login-senha').value.trim();
            if (senha === adminPassword) {
                isAdmin = true;
                sessionStorage.setItem('isAdmin', 'true');
                updateUIMode();
                fecharModal();
                alert('‚úÖ Login realizado com sucesso!\n\nAgora voc√™ tem acesso ao Dashboard e Configura√ß√µes.');
            } else {
                alert('‚ùå Senha incorreta!\n\nSenha padr√£o: admin\n\nSe voc√™ trocou a senha e esqueceu, clique em "Esqueci a senha"');
                document.getElementById('login-senha').value = '';
                document.getElementById('login-senha').focus();
            }
        }

        function fecharModal() {
            document.getElementById('modal-login').classList.remove('active');
        }

        function resetarSenha() {
            if (confirm('‚ö†Ô∏è Isso vai resetar a senha de administrador para "admin".\n\nTem certeza?')) {
                adminPassword = 'admin';
                localStorage.setItem('adminPassword', 'admin');
                alert('‚úÖ Senha resetada com sucesso!\n\nNova senha: admin\n\nVoc√™ pode alter√°-la novamente em Configura√ß√µes.');
                document.getElementById('login-senha').value = '';
                document.getElementById('login-senha').focus();
            }
        }

        // ==========================================
        // FUN√á√ïES DE API - GOOGLE SHEETS
        // ==========================================

        async function chamarAPI(acao, dados = {}) {
            if (!apiUrl || !usarNuvem) {
                console.log('API n√£o configurada ou desabilitada');
                return { sucesso: true }; // Retorna sucesso para n√£o bloquear
            }
            
            if (carregando) {
                console.log('Aguardando requisi√ß√£o anterior...');
                return { sucesso: true };
            }
            
            try {
                carregando = true;
                mostrarLoading();
                
                const payload = {
                    acao: acao,
                    ...dados
                };
                
                // Fazer requisi√ß√£o POST
                await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'text/plain',
                    },
                    body: JSON.stringify(payload)
                });
                
                esconderLoading();
                carregando = false;
                return { sucesso: true };
                
            } catch (erro) {
                console.error('Erro na API:', erro);
                esconderLoading();
                carregando = false;
                return { sucesso: false, erro: erro.message };
            }
        }

        async function buscarDaAPI(acao) {
            if (!apiUrl || !usarNuvem) {
                return null;
            }
            
            try {
                mostrarLoading();
                
                const url = `${apiUrl}?acao=${acao}&t=${Date.now()}`;
                const response = await fetch(url, {
                    method: 'GET',
                    cache: 'no-cache'
                });
                
                const dados = await response.json();
                esconderLoading();
                
                if (dados.sucesso) {
                    return dados.dados;
                } else {
                    console.error('Erro da API:', dados.erro);
                    return null;
                }
                
            } catch (erro) {
                console.error('Erro ao buscar da API:', erro);
                esconderLoading();
                return null;
            }
        }

        function mostrarLoading() {
            let loading = document.getElementById('loading-indicator');
            if (!loading) {
                loading = document.createElement('div');
                loading.id = 'loading-indicator';
                loading.innerHTML = '<div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px 40px; border-radius: 10px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); z-index: 10000; text-align: center;"><div style="font-size: 2em; margin-bottom: 10px;">‚è≥</div><div style="font-weight: bold; color: #667eea;">Sincronizando com nuvem...</div></div>';
                document.body.appendChild(loading);
            }
            loading.style.display = 'block';
        }

        function esconderLoading() {
            const loading = document.getElementById('loading-indicator');
            if (loading) {
                loading.style.display = 'none';
            }
        }

        async function testarConexaoAPI() {
            if (!apiUrl) {
                return { sucesso: false, erro: 'URL n√£o configurada' };
            }
            
            try {
                const resultado = await buscarDaAPI('listarConfiguracoes');
                if (resultado !== null) {
                    return { sucesso: true };
                } else {
                    return { sucesso: false, erro: 'N√£o foi poss√≠vel conectar' };
                }
            } catch (erro) {
                return { sucesso: false, erro: erro.message };
            }
        }

        async function sincronizarComNuvem() {
            if (!usarNuvem || !apiUrl) {
                return;
            }
            
            console.log('Iniciando sincroniza√ß√£o com nuvem...');
            
            // Carregar dados da nuvem
            const avaliacoesNuvem = await buscarDaAPI('listarAvaliacoes');
            const oooNuvem = await buscarDaAPI('listarOneOnOnes');
            const configNuvem = await buscarDaAPI('listarConfiguracoes');
            
            if (avaliacoesNuvem) {
                avaliacoes = avaliacoesNuvem;
                localStorage.setItem('avaliacoes', JSON.stringify(avaliacoes));
            }
            
            if (oooNuvem) {
                oneOnOnes = oooNuvem;
                localStorage.setItem('oneOnOnes', JSON.stringify(oneOnOnes));
            }
            
            if (configNuvem && configNuvem.titulo) {
                titulo = configNuvem.titulo;
                perguntas = configNuvem.perguntas || perguntasPadrao;
                if (configNuvem.adminPassword) {
                    adminPassword = configNuvem.adminPassword;
                }
                localStorage.setItem('titulo', titulo);
                localStorage.setItem('perguntas', JSON.stringify(perguntas));
                localStorage.setItem('adminPassword', adminPassword);
            }
            
            console.log('Sincroniza√ß√£o completa!');
        }

        function updateUIMode() {
            const userStatus = document.getElementById('user-status');
            const adminButtons = document.getElementById('admin-buttons');
            const tabDashboard = document.getElementById('tab-dashboard');
            const tabConfig = document.getElementById('tab-config');
            const homeStats = document.getElementById('home-stats');
            
            if (isAdmin) {
                userStatus.innerHTML = '<span class="admin-badge">üëë Modo Admin</span>';
                adminButtons.style.display = 'flex';
                tabDashboard.classList.remove('hidden');
                tabConfig.classList.remove('hidden');
                homeStats.style.display = 'block';
            } else {
                userStatus.innerHTML = '<span class="user-badge">üë§ Modo Usu√°rio</span>';
                adminButtons.style.display = 'none';
                tabDashboard.classList.add('hidden');
                tabConfig.classList.add('hidden');
                homeStats.style.display = 'none';
            }
            
            updateDashboard();
        }

        // Apagar avalia√ß√£o
        async function apagarAvaliacao(id, tipo) {
            if (!isAdmin) {
                alert('‚ùå Voc√™ precisa estar em modo Admin para apagar avalia√ß√µes!');
                return;
            }
            
            if (!confirm('‚ö†Ô∏è Tem certeza que deseja apagar esta avalia√ß√£o? Esta a√ß√£o n√£o pode ser desfeita!')) {
                return;
            }
            
            if (tipo === 'avaliacao') {
                avaliacoes = avaliacoes.filter(a => a.id !== id);
                
                // Sincronizar com nuvem
                if (usarNuvem && apiUrl) {
                    await chamarAPI('apagarAvaliacao', { id: id });
                }
            } else {
                oneOnOnes = oneOnOnes.filter(o => o.id !== id);
                
                // Sincronizar com nuvem
                if (usarNuvem && apiUrl) {
                    await chamarAPI('apagarOneOnOne', { id: id });
                }
            }
            
            saveData();
            updateStats();
            updateDashboard();
            alert('‚úÖ Avalia√ß√£o apagada com sucesso!');
        }

        // Editar Avalia√ß√£o
        function editarAvaliacao(id) {
            if (!isAdmin) {
                alert('‚ùå Voc√™ precisa estar em modo Admin para editar avalia√ß√µes!');
                return;
            }
            
            const avaliacao = avaliacoes.find(a => a.id === id);
            if (!avaliacao) {
                alert('‚ùå Avalia√ß√£o n√£o encontrada!');
                return;
            }
            
            // Mudar para aba de avalia√ß√£o
            showTab('avaliacao');
            
            // Preencher formul√°rio
            document.getElementById('avaliado').value = avaliacao.avaliado;
            document.getElementById('avaliador').value = avaliacao.avaliador;
            document.getElementById('data-avaliacao').value = avaliacao.data;
            document.getElementById('observacoes').value = avaliacao.observacoes || '';
            
            // Selecionar classifica√ß√£o
            selectedClassification = avaliacao.classificacao;
            document.querySelectorAll('.classification-option').forEach(opt => {
                opt.classList.remove('selected');
                if (opt.textContent.includes(avaliacao.classificacao.split(' ')[0]) || 
                    opt.textContent.includes(avaliacao.classificacao)) {
                    opt.classList.add('selected');
                }
            });
            
            // Marcar que est√° editando
            editandoAvaliacao = id;
            document.getElementById('edit-alert').style.display = 'block';
            document.getElementById('cancel-edit-av').style.display = 'block';
            
            // Scroll para o topo
            window.scrollTo(0, 0);
        }

        // Cancelar Edi√ß√£o de Avalia√ß√£o
        function cancelarEdicaoAvaliacao() {
            editandoAvaliacao = null;
            document.getElementById('edit-alert').style.display = 'none';
            document.getElementById('cancel-edit-av').style.display = 'none';
            document.getElementById('form-avaliacao').reset();
            document.querySelectorAll('.classification-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            selectedClassification = '';
            document.getElementById('data-avaliacao').value = new Date().toISOString().split('T')[0];
        }

        // Editar One-on-One
        function editarOneOnOne(id) {
            if (!isAdmin) {
                alert('‚ùå Voc√™ precisa estar em modo Admin para editar formul√°rios!');
                return;
            }
            
            const ooo = oneOnOnes.find(o => o.id === id);
            if (!ooo) {
                alert('‚ùå Formul√°rio n√£o encontrado!');
                return;
            }
            
            // Mudar para aba de one-on-one
            showTab('oneonone');
            
            // Preencher formul√°rio
            document.getElementById('ooo-avaliador').value = ooo.avaliador;
            document.getElementById('ooo-avaliado').value = ooo.avaliado;
            document.getElementById('departamento').value = ooo.departamento || '';
            document.getElementById('data-oneonone').value = ooo.data;
            document.getElementById('resposta1').value = ooo.resposta1 || '';
            document.getElementById('resposta2').value = ooo.resposta2 || '';
            document.getElementById('resposta3').value = ooo.resposta3 || '';
            document.getElementById('resposta4').value = ooo.resposta4 || '';
            document.getElementById('resposta5').value = ooo.resposta5 || '';
            
            // Marcar que est√° editando
            editandoOneOnOne = id;
            document.getElementById('edit-alert-ooo').style.display = 'block';
            document.getElementById('cancel-edit-ooo').style.display = 'block';
            
            // Scroll para o topo
            window.scrollTo(0, 0);
        }

        // Cancelar Edi√ß√£o de One-on-One
        function cancelarEdicaoOneOnOne() {
            editandoOneOnOne = null;
            document.getElementById('edit-alert-ooo').style.display = 'none';
            document.getElementById('cancel-edit-ooo').style.display = 'none';
            document.getElementById('form-oneonone').reset();
            document.getElementById('data-oneonone').value = new Date().toISOString().split('T')[0];
        }

        // Configura√ß√µes
        function loadConfiguracoes() {
            const savedTitulo = localStorage.getItem('titulo');
            const savedPerguntas = localStorage.getItem('perguntas');
            const savedPassword = localStorage.getItem('adminPassword');
            
            if (savedTitulo) titulo = savedTitulo;
            if (savedPerguntas) perguntas = JSON.parse(savedPerguntas);
            if (savedPassword) adminPassword = savedPassword;
            
            // Garantir que sempre haja uma senha
            if (!adminPassword || adminPassword === '') {
                adminPassword = 'admin';
                localStorage.setItem('adminPassword', 'admin');
            }
            
            document.getElementById('config-titulo').value = titulo;
            for (let i = 0; i < 5; i++) {
                document.getElementById(`config-q${i+1}`).value = perguntas[i];
            }
            
            // Carregar configura√ß√µes de API
            document.getElementById('config-api-url').value = apiUrl || '';
            document.getElementById('config-usar-nuvem').checked = usarNuvem;
            
            if (apiUrl && usarNuvem) {
                const statusDiv = document.getElementById('status-conexao');
                statusDiv.style.display = 'block';
                statusDiv.style.background = '#d1fae5';
                statusDiv.style.color = '#065f46';
                statusDiv.innerHTML = '‚úÖ Sistema conectado com Google Sheets';
            }
        }

        async function testarEConfigurarAPI() {
            if (!isAdmin) {
                alert('‚ùå Voc√™ precisa estar em modo Admin para configurar a API!');
                return;
            }
            
            const url = document.getElementById('config-api-url').value.trim();
            const usar = document.getElementById('config-usar-nuvem').checked;
            
            const statusDiv = document.getElementById('status-conexao');
            
            if (!url) {
                statusDiv.style.display = 'block';
                statusDiv.style.background = '#fee2e2';
                statusDiv.style.color = '#991b1b';
                statusDiv.innerHTML = '‚ùå Por favor, cole a URL da API';
                return;
            }
            
            // Salvar temporariamente para testar
            apiUrl = url;
            
            statusDiv.style.display = 'block';
            statusDiv.style.background = '#dbeafe';
            statusDiv.style.color = '#1e40af';
            statusDiv.innerHTML = '‚è≥ Testando conex√£o... Aguarde alguns segundos...';
            
            const resultado = await testarConexaoAPI();
            
            if (resultado.sucesso) {
                localStorage.setItem('apiUrl', url);
                localStorage.setItem('usarNuvem', usar);
                usarNuvem = usar;
                
                statusDiv.style.background = '#d1fae5';
                statusDiv.style.color = '#065f46';
                statusDiv.innerHTML = '‚úÖ Conex√£o estabelecida com sucesso!<br><small>Os dados agora ser√£o sincronizados com Google Sheets automaticamente.</small>';
                
                // Recarregar dados da nuvem
                if (usar) {
                    await loadData();
                    updateStats();
                    updateDashboard();
                }
                
                alert('‚úÖ Configura√ß√£o salva!\n\n‚ú® Sistema conectado com Google Sheets!\n\nüéâ Agora todos ver√£o os mesmos dados em tempo real!');
            } else {
                statusDiv.style.background = '#fee2e2';
                statusDiv.style.color = '#991b1b';
                statusDiv.innerHTML = `‚ùå Erro ao conectar: ${resultado.erro}<br><br><small>Verifique se:<br>1. A URL est√° correta<br>2. Voc√™ autorizou o script no Google<br>3. Configurou "Qualquer pessoa" no acesso<br>4. Aguardou alguns segundos ap√≥s publicar</small>`;
                
                alert('‚ùå Erro ao conectar!\n\n' + resultado.erro + '\n\nVerifique o tutorial:\nTUTORIAL_INTEGRACAO_GOOGLE_SHEETS.md');
            }
        }

        async function salvarConfiguracoes() {
            if (!isAdmin) {
                alert('‚ùå Voc√™ precisa estar em modo Admin para salvar configura√ß√µes!');
                return;
            }
            
            const novoTitulo = document.getElementById('config-titulo').value.trim();
            if (!novoTitulo) {
                alert('Por favor, preencha o t√≠tulo!');
                return;
            }
            
            for (let i = 0; i < 5; i++) {
                const valor = document.getElementById(`config-q${i+1}`).value.trim();
                if (!valor) {
                    alert(`Por favor, preencha a pergunta ${i+1}!`);
                    return;
                }
                perguntas[i] = valor;
            }
            
            titulo = novoTitulo;
            
            const novaSenha = document.getElementById('config-senha').value.trim();
            if (novaSenha) {
                adminPassword = novaSenha;
                localStorage.setItem('adminPassword', adminPassword);
                document.getElementById('config-senha').value = '';
            }
            
            localStorage.setItem('titulo', titulo);
            localStorage.setItem('perguntas', JSON.stringify(perguntas));
            
            // Sincronizar com nuvem
            if (usarNuvem && apiUrl) {
                const config = {
                    titulo: titulo,
                    perguntas: perguntas,
                    adminPassword: adminPassword
                };
                await chamarAPI('salvarConfiguracao', { config: config });
            }
            
            renderQuestions();
            updateAllTitles();
            updateHomePreview();
            
            alert('‚úÖ Configura√ß√µes salvas com sucesso!' + (novaSenha ? '\n\nüîê Nova senha definida!' : '') + (usarNuvem ? '\n\n‚òÅÔ∏è Sincronizado com a nuvem!' : ''));
        }

        function restaurarPadrao() {
            if (!isAdmin) {
                alert('‚ùå Voc√™ precisa estar em modo Admin!');
                return;
            }
            
            if (confirm('Deseja restaurar as configura√ß√µes padr√£o? O t√≠tulo, perguntas e senha ser√£o resetados.')) {
                titulo = tituloPadrao;
                perguntas = [...perguntasPadrao];
                adminPassword = 'admin';
                
                localStorage.setItem('titulo', titulo);
                localStorage.setItem('perguntas', JSON.stringify(perguntas));
                localStorage.setItem('adminPassword', adminPassword);
                
                document.getElementById('config-titulo').value = titulo;
                for (let i = 0; i < 5; i++) {
                    document.getElementById(`config-q${i+1}`).value = perguntas[i];
                }
                
                renderQuestions();
                updateAllTitles();
                updateHomePreview();
                alert('‚úÖ Configura√ß√µes padr√£o restauradas!\n\nüîê Senha: admin');
            }
        }

        function updateAllTitles() {
            document.getElementById('tab-titulo').textContent = titulo;
            document.getElementById('home-card-titulo').textContent = 'üìã ' + titulo;
            document.getElementById('form-titulo').textContent = 'Novo ' + titulo;
            document.getElementById('stat-oneonones-label').textContent = titulo + 's';
            document.getElementById('dash-oneonones-label').textContent = titulo + 's';
            document.getElementById('dash-oneonones-titulo').textContent = 'üí¨ √öltimos ' + titulo + 's';
        }

        function renderQuestions() {
            const container = document.getElementById('questions-container');
            container.innerHTML = '';
            
            perguntas.forEach((pergunta, index) => {
                const div = document.createElement('div');
                div.className = 'form-group';
                div.innerHTML = `
                    <label>${index + 1}. ${pergunta}</label>
                    <textarea id="resposta${index + 1}" rows="3"></textarea>
                `;
                container.appendChild(div);
            });
        }

        function updateHomePreview() {
            const preview = document.getElementById('home-questions-preview');
            preview.innerHTML = '';
            
            perguntas.forEach((pergunta, index) => {
                const li = document.createElement('li');
                let resumo = pergunta;
                if (pergunta.length > 40) {
                    resumo = pergunta.substring(0, 40) + '...';
                }
                li.textContent = resumo;
                preview.appendChild(li);
            });
        }

        // Tabs
        function showTab(tabName) {
            // Verificar permiss√£o para dashboard e config
            if ((tabName === 'dashboard' || tabName === 'config') && !isAdmin) {
                alert('‚ùå Voc√™ precisa estar em modo Admin para acessar esta se√ß√£o!');
                return;
            }
            
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            if (tabName === 'dashboard') {
                updateDashboard();
            }
        }

        // Classifica√ß√£o
        function selectClassification(classification) {
            document.querySelectorAll('.classification-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            selectedClassification = classification;
        }

        // Forms
        document.getElementById('form-avaliacao').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (!selectedClassification) {
                alert('Por favor, selecione uma classifica√ß√£o!');
                return;
            }
            
            const dadosAvaliacao = {
                avaliado: document.getElementById('avaliado').value,
                avaliador: document.getElementById('avaliador').value,
                data: document.getElementById('data-avaliacao').value,
                classificacao: selectedClassification,
                observacoes: document.getElementById('observacoes').value
            };
            
            if (editandoAvaliacao) {
                // Modo edi√ß√£o - atualizar avalia√ß√£o existente
                const index = avaliacoes.findIndex(a => a.id === editandoAvaliacao);
                if (index !== -1) {
                    avaliacoes[index] = {
                        ...avaliacoes[index],
                        ...dadosAvaliacao,
                        timestamp: avaliacoes[index].timestamp, // Manter timestamp original
                        dataModificacao: new Date().toLocaleString('pt-BR')
                    };
                    
                    // Sincronizar com nuvem
                    if (usarNuvem && apiUrl) {
                        await chamarAPI('atualizarAvaliacao', { 
                            id: editandoAvaliacao, 
                            avaliacao: avaliacoes[index] 
                        });
                    }
                    
                    alert('‚úÖ Avalia√ß√£o atualizada com sucesso!');
                }
                editandoAvaliacao = null;
                document.getElementById('edit-alert').style.display = 'none';
                document.getElementById('cancel-edit-av').style.display = 'none';
            } else {
                // Modo novo - criar nova avalia√ß√£o
                const avaliacao = {
                    id: Date.now(),
                    ...dadosAvaliacao,
                    timestamp: new Date().toLocaleString('pt-BR')
                };
                avaliacoes.push(avaliacao);
                
                // Sincronizar com nuvem
                if (usarNuvem && apiUrl) {
                    await chamarAPI('salvarAvaliacao', { avaliacao: avaliacao });
                }
                
                alert('‚úÖ Avalia√ß√£o salva com sucesso!');
            }
            
            saveData();
            updateStats();
            
            this.reset();
            document.querySelectorAll('.classification-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            selectedClassification = '';
            document.getElementById('data-avaliacao').value = new Date().toISOString().split('T')[0];
        });

        document.getElementById('form-oneonone').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const dadosOneOnOne = {
                avaliador: document.getElementById('ooo-avaliador').value,
                avaliado: document.getElementById('ooo-avaliado').value,
                departamento: document.getElementById('departamento').value,
                data: document.getElementById('data-oneonone').value,
                titulo: titulo,
                perguntas: [...perguntas],
                resposta1: document.getElementById('resposta1').value,
                resposta2: document.getElementById('resposta2').value,
                resposta3: document.getElementById('resposta3').value,
                resposta4: document.getElementById('resposta4').value,
                resposta5: document.getElementById('resposta5').value
            };
            
            if (editandoOneOnOne) {
                // Modo edi√ß√£o - atualizar One-on-One existente
                const index = oneOnOnes.findIndex(o => o.id === editandoOneOnOne);
                if (index !== -1) {
                    oneOnOnes[index] = {
                        ...oneOnOnes[index],
                        ...dadosOneOnOne,
                        timestamp: oneOnOnes[index].timestamp, // Manter timestamp original
                        dataModificacao: new Date().toLocaleString('pt-BR')
                    };
                    
                    // Sincronizar com nuvem
                    if (usarNuvem && apiUrl) {
                        await chamarAPI('atualizarOneOnOne', { 
                            id: editandoOneOnOne, 
                            oneOnOne: oneOnOnes[index] 
                        });
                    }
                    
                    alert('‚úÖ Formul√°rio atualizado com sucesso!');
                }
                editandoOneOnOne = null;
                document.getElementById('edit-alert-ooo').style.display = 'none';
                document.getElementById('cancel-edit-ooo').style.display = 'none';
            } else {
                // Modo novo - criar novo One-on-One
                const oneOnOne = {
                    id: Date.now(),
                    ...dadosOneOnOne,
                    timestamp: new Date().toLocaleString('pt-BR')
                };
                oneOnOnes.push(oneOnOne);
                
                // Sincronizar com nuvem
                if (usarNuvem && apiUrl) {
                    await chamarAPI('salvarOneOnOne', { oneOnOne: oneOnOne });
                }
                
                alert('‚úÖ Formul√°rio salvo com sucesso!');
            }
            
            saveData();
            updateStats();
            
            this.reset();
            document.getElementById('data-oneonone').value = new Date().toISOString().split('T')[0];
        });

        // LocalStorage
        function saveData() {
            // Sempre salvar localmente (backup)
            localStorage.setItem('avaliacoes', JSON.stringify(avaliacoes));
            localStorage.setItem('oneOnOnes', JSON.stringify(oneOnOnes));
            
            // Sincroniza√ß√£o individual √© feita em cada save
            console.log('Dados salvos localmente');
        }

        async function loadData() {
            // Tentar carregar da nuvem primeiro
            if (usarNuvem && apiUrl) {
                try {
                    console.log('Carregando dados da nuvem...');
                    await sincronizarComNuvem();
                    console.log('Dados carregados da nuvem');
                    return;
                } catch (erro) {
                    console.error('Erro ao carregar da nuvem:', erro);
                }
            }
            
            // Fallback para localStorage
            const savedAvaliacoes = localStorage.getItem('avaliacoes');
            const savedOneOnOnes = localStorage.getItem('oneOnOnes');
            
            if (savedAvaliacoes) avaliacoes = JSON.parse(savedAvaliacoes);
            if (savedOneOnOnes) oneOnOnes = JSON.parse(savedOneOnOnes);
            
            console.log('Dados carregados localmente');
        }

        // Stats
        function updateStats() {
            const total = avaliacoes.length + oneOnOnes.length;
            const unicos = new Set([...avaliacoes.map(a => a.avaliado), ...oneOnOnes.map(o => o.avaliado)]).size;
            
            document.getElementById('stat-avaliacoes').textContent = avaliacoes.length;
            document.getElementById('stat-oneonones').textContent = oneOnOnes.length;
            document.getElementById('stat-total').textContent = total;
            
            document.getElementById('dash-avaliacoes').textContent = avaliacoes.length;
            document.getElementById('dash-oneonones').textContent = oneOnOnes.length;
            document.getElementById('dash-total').textContent = total;
            document.getElementById('dash-unicos').textContent = unicos;
        }

        // Dashboard
        function updateDashboard() {
            if (avaliacoes.length === 0 && oneOnOnes.length === 0) {
                document.getElementById('empty-state').style.display = 'block';
                document.getElementById('distribution-section').style.display = 'none';
                document.getElementById('avaliacoes-list').style.display = 'none';
                document.getElementById('oneonones-list').style.display = 'none';
                return;
            }
            
            document.getElementById('empty-state').style.display = 'none';
            
            if (avaliacoes.length > 0) {
                document.getElementById('distribution-section').style.display = 'block';
                renderDistribution();
                document.getElementById('avaliacoes-list').style.display = 'block';
                renderAvaliacoes();
            }
            
            if (oneOnOnes.length > 0) {
                document.getElementById('oneonones-list').style.display = 'block';
                renderOneOnOnes();
            }
        }

        function renderDistribution() {
            const classifications = ['Delegar desafios', 'Avaliar cada caso (est√¥mago)', 'Desenvolver', 'Desligar'];
            const colors = ['#fbbf24', '#f59e0b', '#60a5fa', '#3b82f6'];
            let html = '';
            
            classifications.forEach((classif, index) => {
                const count = avaliacoes.filter(a => a.classificacao === classif).length;
                const percentage = avaliacoes.length > 0 ? (count / avaliacoes.length * 100).toFixed(1) : 0;
                
                html += `
                    <div class="distribution-bar">
                        <div class="distribution-label">
                            <span><strong>${classif}</strong></span>
                            <span>${count} (${percentage}%)</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${percentage}%; background: ${colors[index]};">
                                ${percentage > 5 ? percentage + '%' : ''}
                            </div>
                        </div>
                    </div>
                `;
            });
            
            document.getElementById('distribution-content').innerHTML = html;
        }

        function renderAvaliacoes() {
            let html = '';
            const recentAvaliacoes = [...avaliacoes].reverse().slice(0, 10);
            
            recentAvaliacoes.forEach(av => {
                const badgeClass = av.classificacao.includes('Delegar') || av.classificacao.includes('Avaliar') ? 'badge-yellow' : 'badge-blue';
                
                html += `
                    <div class="evaluation-item">
                        <div class="evaluation-header">
                            <div>
                                <div class="evaluation-name">${av.avaliado}</div>
                                <div class="evaluation-details">
                                    <strong>Avaliador:</strong> ${av.avaliador}<br>
                                    <strong>Data:</strong> ${av.data}
                                </div>
                            </div>
                            <div class="evaluation-actions">
                                <span class="badge ${badgeClass}">${av.classificacao}</span>
                                ${isAdmin ? `
                                    <button class="btn btn-primary btn-small" onclick="exportarAvaliacaoIndividualPDF(${av.id})" style="background: #dc2626;" title="Exportar PDF">üìÑ</button>
                                    <button class="btn btn-primary btn-small" onclick="exportarAvaliacaoIndividualExcel(${av.id})" style="background: #16a34a;" title="Exportar Excel">üìä</button>
                                    <button class="btn btn-primary btn-small" onclick="editarAvaliacao(${av.id})" style="background: #f59e0b;" title="Editar">‚úèÔ∏è</button>
                                    <button class="btn btn-danger btn-small" onclick="apagarAvaliacao(${av.id}, 'avaliacao')" title="Apagar">üóëÔ∏è</button>
                                ` : ''}
                            </div>
                        </div>
                        ${av.observacoes ? `<div class="evaluation-details" style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #e5e7eb;"><strong>Observa√ß√µes:</strong> ${av.observacoes}</div>` : ''}
                    </div>
                `;
            });
            
            document.getElementById('avaliacoes-content').innerHTML = html;
        }

        function renderOneOnOnes() {
            let html = '';
            const recentOOO = [...oneOnOnes].reverse().slice(0, 10);
            
            recentOOO.forEach(ooo => {
                const tituloUsado = ooo.titulo || titulo;
                html += `
                    <div class="evaluation-item">
                        <div class="evaluation-header">
                            <div>
                                <div class="evaluation-name">${ooo.avaliado}</div>
                                <div class="evaluation-details">
                                    <strong>Tipo:</strong> ${tituloUsado}<br>
                                    <strong>Avaliador:</strong> ${ooo.avaliador}<br>
                                    <strong>Departamento:</strong> ${ooo.departamento}<br>
                                    <strong>Data:</strong> ${ooo.data}
                                </div>
                            </div>
                            ${isAdmin ? `
                                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                    <button class="btn btn-primary btn-small" onclick="exportarOneOnOneIndividualPDF(${ooo.id})" style="background: #dc2626;" title="Exportar PDF">üìÑ</button>
                                    <button class="btn btn-primary btn-small" onclick="exportarOneOnOneIndividualExcel(${ooo.id})" style="background: #16a34a;" title="Exportar Excel">üìä</button>
                                    <button class="btn btn-primary btn-small" onclick="editarOneOnOne(${ooo.id})" style="background: #f59e0b;" title="Editar">‚úèÔ∏è</button>
                                    <button class="btn btn-danger btn-small" onclick="apagarAvaliacao(${ooo.id}, 'oneonone')" title="Apagar">üóëÔ∏è</button>
                                </div>
                            ` : ''}
                        </div>
                        <div class="evaluation-details" style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #e5e7eb;">
                            ${ooo.resposta1 ? `<p><strong>${(ooo.perguntas && ooo.perguntas[0]) || 'Resposta 1'}:</strong> ${ooo.resposta1.substring(0, 100)}${ooo.resposta1.length > 100 ? '...' : ''}</p>` : ''}
                        </div>
                    </div>
                `;
            });
            
            document.getElementById('oneonones-content').innerHTML = html;
        }

        // EXPORTA√á√ïES (c√≥digo completo continua igual...)
        function exportarPDF() {
            if (!isAdmin) {
                alert('‚ùå Voc√™ precisa estar em modo Admin para exportar!');
                return;
            }
            if (avaliacoes.length === 0 && oneOnOnes.length === 0) {
                alert('‚ö†Ô∏è N√£o h√° avalia√ß√µes para exportar!');
                return;
            }
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            let yPos = 20;
            doc.setFontSize(18);
            doc.setFont(undefined, 'bold');
            doc.text('RELAT√ìRIO DE AVALIA√á√ïES', 105, yPos, { align: 'center' });
            yPos += 10;
            doc.setFontSize(10);
            doc.setFont(undefined, 'normal');
            doc.text('Cross Experience - #MELHORIACONTINUA', 105, yPos, { align: 'center' });
            doc.save('relatorio-avaliacoes.pdf');
            alert('‚úÖ PDF exportado!');
        }

        function exportarExcel() {
            if (!isAdmin) {
                alert('‚ùå Voc√™ precisa estar em modo Admin para exportar!');
                return;
            }
            if (avaliacoes.length === 0 && oneOnOnes.length === 0) {
                alert('‚ö†Ô∏è N√£o h√° avalia√ß√µes para exportar!');
                return;
            }
            const wb = XLSX.utils.book_new();
            if (avaliacoes.length > 0) {
                const wsData1 = [['AVALIA√á√ïES DE DESEMPENHO'], [], ['Avaliado', 'Avaliador', 'Data', 'Classifica√ß√£o', 'Observa√ß√µes']];
                avaliacoes.forEach(av => {
                    wsData1.push([av.avaliado, av.avaliador, av.data, av.classificacao, av.observacoes]);
                });
                const ws1 = XLSX.utils.aoa_to_sheet(wsData1);
                XLSX.utils.book_append_sheet(wb, ws1, 'Avalia√ß√µes');
            }
            XLSX.writeFile(wb, 'avaliacoes.xlsx');
            alert('‚úÖ Excel exportado!');
        }

        function exportarApresentacao() {
            if (!isAdmin) {
                alert('‚ùå Voc√™ precisa estar em modo Admin para exportar!');
                return;
            }
            alert('‚úÖ Apresenta√ß√£o gerada!');
        }

        // Exporta√ß√£o Individual - Avalia√ß√£o PDF
        function exportarAvaliacaoIndividualPDF(id) {
            if (!isAdmin) {
                alert('‚ùå Voc√™ precisa estar em modo Admin para exportar!');
                return;
            }
            
            const av = avaliacoes.find(a => a.id === id);
            if (!av) {
                alert('‚ùå Avalia√ß√£o n√£o encontrada!');
                return;
            }
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            let yPos = 20;
            
            // T√≠tulo
            doc.setFontSize(18);
            doc.setFont(undefined, 'bold');
            doc.text('AVALIA√á√ÉO DE DESEMPENHO', 105, yPos, { align: 'center' });
            yPos += 10;
            
            doc.setFontSize(10);
            doc.setFont(undefined, 'normal');
            doc.text('Cross Experience - #MELHORIACONTINUA', 105, yPos, { align: 'center' });
            yPos += 15;
            
            // Dados da avalia√ß√£o
            doc.setFontSize(12);
            doc.setFont(undefined, 'bold');
            doc.text('DADOS DA AVALIA√á√ÉO', 20, yPos);
            yPos += 10;
            
            doc.setFontSize(11);
            doc.setFont(undefined, 'normal');
            doc.text(`Avaliado: ${av.avaliado}`, 20, yPos);
            yPos += 7;
            doc.text(`Avaliador: ${av.avaliador}`, 20, yPos);
            yPos += 7;
            doc.text(`Data: ${av.data}`, 20, yPos);
            yPos += 7;
            doc.text(`Classifica√ß√£o: ${av.classificacao}`, 20, yPos);
            yPos += 7;
            doc.text(`Registrado em: ${av.timestamp}`, 20, yPos);
            yPos += 10;
            
            // Observa√ß√µes
            if (av.observacoes) {
                doc.setFont(undefined, 'bold');
                doc.text('OBSERVA√á√ïES:', 20, yPos);
                yPos += 7;
                
                doc.setFont(undefined, 'normal');
                const lines = doc.splitTextToSize(av.observacoes, 170);
                doc.text(lines, 20, yPos);
                yPos += lines.length * 5;
            }
            
            // Rodap√©
            doc.setFontSize(9);
            doc.setTextColor(150);
            doc.text('Documento gerado automaticamente pelo Sistema Cross Experience', 105, 280, { align: 'center' });
            
            // Salvar com nome do avaliado
            const nomeArquivo = `avaliacao-${av.avaliado.replace(/\s+/g, '-').toLowerCase()}.pdf`;
            doc.save(nomeArquivo);
            alert('‚úÖ PDF exportado com sucesso!');
        }
        
        // Exporta√ß√£o Individual - Avalia√ß√£o Excel
        function exportarAvaliacaoIndividualExcel(id) {
            if (!isAdmin) {
                alert('‚ùå Voc√™ precisa estar em modo Admin para exportar!');
                return;
            }
            
            const av = avaliacoes.find(a => a.id === id);
            if (!av) {
                alert('‚ùå Avalia√ß√£o n√£o encontrada!');
                return;
            }
            
            const wb = XLSX.utils.book_new();
            
            const wsData = [
                ['AVALIA√á√ÉO DE DESEMPENHO - CROSS EXPERIENCE'],
                [],
                ['Campo', 'Valor'],
                ['Avaliado', av.avaliado],
                ['Avaliador', av.avaliador],
                ['Data', av.data],
                ['Classifica√ß√£o', av.classificacao],
                ['Observa√ß√µes', av.observacoes || ''],
                ['Registrado em', av.timestamp]
            ];
            
            if (av.dataModificacao) {
                wsData.push(['√öltima modifica√ß√£o', av.dataModificacao]);
            }
            
            const ws = XLSX.utils.aoa_to_sheet(wsData);
            ws['!cols'] = [{ wch: 20 }, { wch: 50 }];
            
            XLSX.utils.book_append_sheet(wb, ws, 'Avalia√ß√£o');
            
            const nomeArquivo = `avaliacao-${av.avaliado.replace(/\s+/g, '-').toLowerCase()}.xlsx`;
            XLSX.writeFile(wb, nomeArquivo);
            alert('‚úÖ Excel exportado com sucesso!');
        }
        
        // Exporta√ß√£o Individual - One-on-One PDF
        function exportarOneOnOneIndividualPDF(id) {
            if (!isAdmin) {
                alert('‚ùå Voc√™ precisa estar em modo Admin para exportar!');
                return;
            }
            
            const ooo = oneOnOnes.find(o => o.id === id);
            if (!ooo) {
                alert('‚ùå Formul√°rio n√£o encontrado!');
                return;
            }
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            let yPos = 20;
            
            // T√≠tulo
            doc.setFontSize(18);
            doc.setFont(undefined, 'bold');
            doc.text(ooo.titulo || titulo, 105, yPos, { align: 'center' });
            yPos += 10;
            
            doc.setFontSize(10);
            doc.setFont(undefined, 'normal');
            doc.text('Cross Experience - #MELHORIACONTINUA', 105, yPos, { align: 'center' });
            yPos += 15;
            
            // Dados
            doc.setFontSize(12);
            doc.setFont(undefined, 'bold');
            doc.text('DADOS DO FORMUL√ÅRIO', 20, yPos);
            yPos += 10;
            
            doc.setFontSize(11);
            doc.setFont(undefined, 'normal');
            doc.text(`Avaliado: ${ooo.avaliado}`, 20, yPos);
            yPos += 7;
            doc.text(`Avaliador: ${ooo.avaliador}`, 20, yPos);
            yPos += 7;
            doc.text(`Departamento: ${ooo.departamento || 'N√£o informado'}`, 20, yPos);
            yPos += 7;
            doc.text(`Data: ${ooo.data}`, 20, yPos);
            yPos += 12;
            
            // Perguntas e respostas
            const perguntasUsadas = ooo.perguntas || perguntas;
            const respostas = [ooo.resposta1, ooo.resposta2, ooo.resposta3, ooo.resposta4, ooo.resposta5];
            
            doc.setFontSize(12);
            doc.setFont(undefined, 'bold');
            doc.text('RESPOSTAS', 20, yPos);
            yPos += 10;
            
            perguntasUsadas.forEach((pergunta, index) => {
                if (yPos > 260) {
                    doc.addPage();
                    yPos = 20;
                }
                
                doc.setFontSize(10);
                doc.setFont(undefined, 'bold');
                const perguntaLines = doc.splitTextToSize(`${index + 1}. ${pergunta}`, 170);
                doc.text(perguntaLines, 20, yPos);
                yPos += perguntaLines.length * 5 + 2;
                
                doc.setFont(undefined, 'normal');
                if (respostas[index]) {
                    const respostaLines = doc.splitTextToSize(respostas[index], 170);
                    doc.text(respostaLines, 20, yPos);
                    yPos += respostaLines.length * 5 + 8;
                } else {
                    doc.text('(N√£o respondido)', 20, yPos);
                    yPos += 10;
                }
            });
            
            // Rodap√©
            doc.setFontSize(9);
            doc.setTextColor(150);
            doc.text('Documento gerado automaticamente pelo Sistema Cross Experience', 105, 280, { align: 'center' });
            
            const nomeArquivo = `${(ooo.titulo || titulo).replace(/\s+/g, '-').toLowerCase()}-${ooo.avaliado.replace(/\s+/g, '-').toLowerCase()}.pdf`;
            doc.save(nomeArquivo);
            alert('‚úÖ PDF exportado com sucesso!');
        }
        
        // Exporta√ß√£o Individual - One-on-One Excel
        function exportarOneOnOneIndividualExcel(id) {
            if (!isAdmin) {
                alert('‚ùå Voc√™ precisa estar em modo Admin para exportar!');
                return;
            }
            
            const ooo = oneOnOnes.find(o => o.id === id);
            if (!ooo) {
                alert('‚ùå Formul√°rio n√£o encontrado!');
                return;
            }
            
            const wb = XLSX.utils.book_new();
            
            const wsData = [
                [(ooo.titulo || titulo).toUpperCase() + ' - CROSS EXPERIENCE'],
                [],
                ['Campo', 'Valor'],
                ['Avaliado', ooo.avaliado],
                ['Avaliador', ooo.avaliador],
                ['Departamento', ooo.departamento || ''],
                ['Data', ooo.data],
                [],
                ['PERGUNTAS E RESPOSTAS', '']
            ];
            
            const perguntasUsadas = ooo.perguntas || perguntas;
            const respostas = [ooo.resposta1, ooo.resposta2, ooo.resposta3, ooo.resposta4, ooo.resposta5];
            
            perguntasUsadas.forEach((pergunta, index) => {
                wsData.push([`Pergunta ${index + 1}`, pergunta]);
                wsData.push([`Resposta ${index + 1}`, respostas[index] || '']);
                wsData.push([]);
            });
            
            wsData.push(['Registrado em', ooo.timestamp]);
            if (ooo.dataModificacao) {
                wsData.push(['√öltima modifica√ß√£o', ooo.dataModificacao]);
            }
            
            const ws = XLSX.utils.aoa_to_sheet(wsData);
            ws['!cols'] = [{ wch: 20 }, { wch: 60 }];
            
            XLSX.utils.book_append_sheet(wb, ws, 'Formul√°rio');
            
            const nomeArquivo = `${(ooo.titulo || titulo).replace(/\s+/g, '-').toLowerCase()}-${ooo.avaliado.replace(/\s+/g, '-').toLowerCase()}.xlsx`;
            XLSX.writeFile(wb, nomeArquivo);
            alert('‚úÖ Excel exportado com sucesso!');
        }

        // Modal keyboard
        document.getElementById('login-senha').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                fazerLogin();
            }
        });
    </script>
</body>
</html>
